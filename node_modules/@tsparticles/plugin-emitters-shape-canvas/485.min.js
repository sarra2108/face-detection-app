/*! For license information please see 485.min.js.LICENSE.txt */
(this.webpackChunk_tsparticles_plugin_emitters_shape_canvas=this.webpackChunk_tsparticles_plugin_emitters_shape_canvas||[]).push([[485],{485:(t,e,i)=>{i.d(e,{EmittersCanvasShapeGenerator:()=>g});var s=i(526),o=i(303);const n={x:0,y:0};function a(t,e,i,s=!0){const o=t.getImageData(n.x,n.y,e.width,e.height).data;s&&t.clearRect(n.x,n.y,e.width,e.height);const a=[];for(let t=0;t<o.length;t+=i){const s=t/i,n={x:s%e.width,y:Math.floor(s/e.width)};a[n.y]||(a[n.y]=[]);const r={r:0,g:1,b:2,a:3},h=255;a[n.y][n.x]={r:o[t+r.r],g:o[t+r.g],b:o[t+r.b],a:o[t+r.a]/h}}return{pixels:a,width:Math.min(...a.map((t=>t.length))),height:a.length}}class r extends s.EmitterShapeBase{constructor(t,e,i,s){super(t,e,i,s);const n=s.filter;let a=t=>t.a>0;if(void 0!==n)if((0,o.isString)(n)){if(Object.hasOwn(window,n)){const t=window[n];(0,o.isFunction)(t)&&(a=t)}}else a=n;this.filter=a,this.scale=s.scale,this.pixelData={pixels:[],height:0,width:0}}async init(){let t;const e=this.options,i=e.selector,s=e.pixels,r=e.image,h=e.element,l=e.text,c=s.offset;if(r){const e=r.src;if(!e)return;t=await function(t,e){const i=new Image;i.crossOrigin="Anonymous";const s=new Promise(((t,s)=>{i.onerror=s,i.onload=()=>{const r=document.createElement("canvas");r.width=i.width,r.height=i.height;const h=r.getContext("2d");if(!h)return s(new Error(`${o.errorPrefix} Could not get canvas context`));h.drawImage(i,n.x,n.y,i.width,i.height,n.x,n.y,r.width,r.height),t(a(h,r,e))}}));return i.src=t,s}(e,c)}else if(l){const e=function(t,e,i){const s=document.createElement("canvas"),r=s.getContext("2d"),{font:h,text:l,lines:c,color:d}=t;if(!l||!r)return;const f=l.split(c.separator),g=(0,o.isNumber)(h.size)?`${h.size}px`:h.size,x=[];let u=0,p=0;for(const t of f){r.font=`${h.style||""} ${h.variant||""} ${h.weight||""} ${g} ${h.family}`;const e=r.measureText(t),i={measure:e,text:t,height:e.actualBoundingBoxAscent+e.actualBoundingBoxDescent,width:e.width};u=Math.max(u||0,i.width),p+=i.height+c.spacing,x.push(i)}s.width=u,s.height=p;let w=0;for(const t of x)r.font=`${h.style||""} ${h.variant||""} ${h.weight||""} ${g} ${h.family}`,i?(r.fillStyle=d,r.fillText(t.text,n.x,w+t.measure.actualBoundingBoxAscent)):(r.strokeStyle=d,r.strokeText(t.text,n.x,w+t.measure.actualBoundingBoxAscent)),w+=t.height+c.spacing;return a(r,s,e)}(l,c,this.fill);if(!e)return;t=e}else if(h??i){const e=h??(i&&document.querySelector(i));if(!e)return;const s=e.getContext("2d");if(!s)return;t=a(s,e,c)}t&&(this.pixelData=t)}randomPosition(){const{height:t,width:e}=this.pixelData,i=this.pixelData,s=this.position,n=this.scale,a=s.x-e*n*.5,r=s.y-t*n*.5;for(let s=0;s<100;s++){const s=Math.floor((0,o.getRandom)()*e*t),h={x:s%e,y:Math.floor(s/e)},l=i.pixels[h.y][h.x];if(this.filter(l))return{position:{x:h.x*n+a,y:h.y*n+r},color:{...l},opacity:l.a}}return null}resize(t,e){super.resize(t,e)}}class h{constructor(){this.offset=4}load(t){t&&void 0!==t.offset&&(this.offset=t.offset)}}class l{constructor(){this.family="Verdana",this.size=32,this.style="",this.variant="",this.weight=""}load(t){t&&(void 0!==t.family&&(this.family=t.family),void 0!==t.size&&(this.size=t.size),void 0!==t.style&&(this.style=t.style),void 0!==t.variant&&(this.variant=t.variant),void 0!==t.weight&&(this.weight=t.weight))}}class c{constructor(){this.separator="\n",this.spacing=0}load(t){t&&(void 0!==t.separator&&(this.separator=t.separator),void 0!==t.spacing&&(this.spacing=t.spacing))}}class d{constructor(){this.color="#000000",this.font=new l,this.lines=new c,this.text=""}load(t){t&&(void 0!==t.color&&(this.color=t.color),this.font.load(t.font),this.lines.load(t.lines),void 0!==t.text&&(this.text=t.text))}}class f{constructor(){this.filter=t=>t.a>0,this.pixels=new h,this.scale=1,this.selector="",this.text=new d}load(t){t&&(void 0!==t.element&&(this.element=t.element),void 0!==t.filter&&(this.filter=t.filter),this.pixels.load(t.pixels),void 0!==t.scale&&(this.scale=t.scale),void 0!==t.selector&&(this.selector=t.selector),void 0!==t.image&&(this.image=t.image),this.text.load(t.text))}}class g{generate(t,e,i,s){const o=new f;return o.load(s),new r(t,e,i,o)}}}}]);